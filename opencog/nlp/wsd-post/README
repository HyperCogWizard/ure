
                             wsd-post
                             --------
                 Linas Vepstas == December 2008
  Miscellaneous scripts for post-processing word-sense disambiguation data.


The wsd directory contains an implementation of the Rada Mihalcea word-sense
disambiguation algorithm. The scm directory contains a set of scripts that
attach word senses to link-grammar parse disjuncts, and then update the 
corresponding scripts in SQL tables. SQL is used because it can take weeks
(or months) to accumulat a sufficient amount of statistics to be meaningul.
This directory contains code that implements the next steps in this processing
pipeline: scripts to compute marginal probabilities, obtained from the raw
counts stored in the SQL database.

The general analysis framework here is an outgrowth of the code that is found
in the 'lexical attraction' package, which is a distinct launchpad project.
In particular, the SQL table definitions are given there, not here. This
cross-project tie-in is a bit of a mess at the moment;  its not clear how
to best resolve it.

Overview, Notes
---------------
The database contains counts for triples consisting of (sense, disjunct, word)
where 'sense' is a wordnet sense-key, obtained by the Mihalcea algo, 'disjunct'
is a link-grammar disjunct that was used to link a given word instance, and 
'word' is an word instance (as used in some sentence) in 'inflected' form (in
the form in which it appears in a link-grammar dictionary). The inflections
are typically '.v' for verbs, '.g' for gerunds, etc.

(Need explanation of why we're doing this)


The probability of interest is p(s|d,w). If this is close to 1, this indicates
that a a certain word sense is being used almost uniquly/exclusively in a
certain context. By contrast, if this is close to zero, this indicates that 
the given sense is almost never used with the disjunct.

Also interesting is the entropy of a disjunct-word pair, summed over senses:
H(d,w) = - \sum_s p(s|d,w) log_2 p(s|d,w)

The basic idea is that low-entropy word-disjunct pairs imply a strong
clustering of disjuncts-to-senses.

rattle() package.
---------------


To update the stats in the db, run ./synset-renorm.pl then ./dj-probs.pl
------------------------------------------------

   select * from disjunctsenses order by count desc;

   select * from disjuncts order by count desc;
   select * from disjuncts where log_cond_probability > 0.0 order by log_cond_probability asc;

Low entropy, but multiple senses observed says that there is a strong corellation
between disjunct and inflected word:
   select * from disjuncts where senses_observed>1 order by entropy asc;

Combine the query:
   select disjuncts.inflected_word, disjuncts.disjunct, disjunctsenses.word_sense,
   disjuncts.entropy, disjuncts.senses_observed, disjunctsenses.count
   from disjuncts,disjunctsenses where
   disjuncts.senses_observed>1 and 
   disjuncts.inflected_word = disjunctsenses.inflected_word and
   disjuncts.disjunct = disjunctsenses.disjunct 
   order by disjuncts.entropy asc;


Suffers:
--------
Candidates:
  inflected_word   |                        disjunct                        |              word_sense               |       entropy       | senses_observed |        count         
-------------------+--------------------------------------------------------+---------------------------------------+---------------------+-----------------+----------------------
 suffers.v         | Ss- Os+ MVp+                                           | have%2:29:05::                        | 0.00591198141479204 |               2 |     1.16565684723427
 suffers.v         | Ss- Os+ MVp+                                           | get%2:29:11::                         | 0.00591198141479204 |               2 |   0.0005521501501815

Here, have%2:29:05:: is in the same synset as get%2:29:11:: (which is suffer%2:29:01::),

Since these both belong to the same synset, they should really be merged.
Done, the synset-renorm.pl script merges records that have the same synset.

She suffered a fracture in the accident"; 
"He suffered an insulin shock after eating three candy bars"; -- "He had an insulin shock after eating three candy bars"; 
"She suffered a bruise on her leg"; -- "She got a bruise on her leg"; 
"He got his arm broken in the scuffle"

This is clearly a differnt meaning than:
The new secretary had to suffer a lot of unprofessional remarks (which is I- Op+)
She was suffering after the accident,
She is suffering from the hot weather
She suffers from a tendency to talk too much (which is Ss- MVp+ MVp+, or MVa+, MVi+, etc.)
She suffered a terrible fate. (Ss- Os+)
This author really suffers in translation (Ss- MVp+)

Now, suffers.v is in words.v.2.2 which has the rules

/en/words/words.v.2.2: <verb-s> & <vc-tr,intr>;
<verb-s>: {@E-} & (Ss- or (RS- & Bs-));
<vc-tr,intr>: {O+ or B- or [[@MV+ & O*n+]]} & {@MV+};

The suffers.v | Ss- Os+ MVp+ disjuncts mean "transitive verb with a preposition",
and this seems to strongly indicate that the correct sense is *always* (suffer%2:29:01::)
for this sentence construction.

How about the past tense?

 suffered.v        | Ss- MVp+                                               | have%2:29:05::                        |   0.0110064468007726 |               2 |      9.8004159256032
 suffered.v        | Ss- MVp+                                               | get%2:29:11::                         |   0.0110064468007726 |               2 |   0.0094159056457721

she suffered a stroke   dj=Ss- Os+ 

Other Candidates
----------------


 towns.n           | Jp- Dmc-                                               | town%1:14:00::                        |  0.00717972910706398 |               2 |  0.00047381451237468
 towns.n           | Jp- Dmc-                                               | town%1:15:00::                        |  0.00717972910706398 |               2 |    0.802619180446346


 battles.n         | Jp- Dmc- Mp+                                           | fight%1:04:01::                       |  0.00727841436704783 |               2 |     2.01007201806988
 battles.n         | Jp- Dmc- Mp+                                           | battle%1:04:02::                      |  0.00727841436704783 |               2 |  0.00120515153578474

 building.n        | Wd- Ds- Ss+                                            | building%1:06:00::                    |  0.00901884557840178 |               2 |     1.82290246346794
 building.n        | Wd- Ds- Ss+                                            | building%1:04:00::                    |  0.00901884557840178 |               2 |  0.00139490596324197


TODO
----
Normalize the synsets -- e.g. suffer is listed witht he wrong synset ... 
Also -- need to merge the sysnsets.
Also -- need to make sure the wsd is uzing only one word per sysnet .. ??
